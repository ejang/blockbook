<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Secret of Our Success — 목차별 핵심 요약 (Interactive)</title>
  <meta name="description" content="조지프 헨릭 『The Secret of Our Success』 목차별 핵심 요약을 인터랙티브하게 탐색하는 단일 페이지" />
  <style>
    :root{
      --bg:#0b1020; --panel:#0f1730; --panel2:#101a38; --text:#e8ecff; --muted:#a8b3e6;
      --accent:#7aa2ff; --accent2:#66e3c4; --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", sans-serif;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0; font-family:var(--sans); color:var(--text);
      background: var(--bg);
      min-height:100vh;
      overscroll-behavior: none;
    }
    a{color:inherit}
    .wrap{max-width:1200px; margin:0 auto; padding:28px 18px 48px; min-height:100vh; background:var(--bg);}

    header{
      display:flex; gap:16px; align-items:flex-start; justify-content:space-between;
      padding:18px 18px 0;
    }
    .title{
      display:flex; flex-direction:column; gap:8px;
    }
    h1{margin:0; font-size:28px; letter-spacing:-0.02em}
    .subtitle{color:var(--muted); line-height:1.4}
    .badgeRow{display:flex; flex-wrap:wrap; gap:8px; margin-top:6px}
    .badge{border:1px solid var(--line); padding:6px 10px; border-radius:999px; font-size:12px; color:var(--muted); background:rgba(255,255,255,.03)}
    .badge b{color:var(--text)}

    .layout{display:grid; grid-template-columns: 340px 1fr; gap:16px; margin-top:18px; background:var(--bg);}
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr}
      header{flex-direction:column}
    }

    .card{
      background: var(--panel2);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .side{padding:14px}

    .toolbar{display:flex; flex-direction:column; gap:10px; padding:12px; border-radius:14px; background:rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.08)}
    .toolbarRow{display:flex; gap:10px; align-items:center}
    .toolbar label{font-size:12px; color:var(--muted)}
    input[type="search"]{
      width:100%; padding:12px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12);
      background:rgba(16,26,56,.55); color:var(--text);
      outline:none;
    }
    input[type="search"]:focus{border-color:rgba(122,162,255,.6); box-shadow:0 0 0 4px rgba(122,162,255,.12)}

    .chips{display:flex; flex-wrap:wrap; gap:8px}
    .chip{
      cursor:pointer; user-select:none;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.03);
      padding:8px 10px; border-radius:999px;
      font-size:12px; color:var(--muted);
      transition: .15s ease;
    }
    .chip:hover{border-color:rgba(122,162,255,.55); color:var(--text)}
    .chip.active{border-color:rgba(102,227,196,.7); color:var(--text); background:rgba(102,227,196,.10)}

    .btnRow{display:flex; gap:10px; flex-wrap:wrap}
    button{
      cursor:pointer; border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      color:var(--text); padding:10px 12px; border-radius:12px;
      transition:.15s ease; font-size:13px;
    }
    button:hover{border-color:rgba(122,162,255,.55); background:rgba(122,162,255,.08)}
    button.primary{border-color:rgba(102,227,196,.65); background:rgba(102,227,196,.10)}
    button.primary:hover{background:rgba(102,227,196,.16)}

    .toc{margin-top:12px; padding:0; list-style:none; max-height: calc(100vh - 290px); overflow:auto}
    @media (max-width: 980px){
      .toc{max-height: none}
    }
    .tocItem{
      display:flex; flex-direction:column; gap:6px;
      padding:12px; margin:8px 0;
      border-radius:14px; border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.16);
      cursor:pointer;
      transition:.15s ease;
    }
    .tocItem:hover{border-color:rgba(122,162,255,.55)}
    .tocItem.active{border-color:rgba(102,227,196,.7); background:rgba(102,227,196,.08)}
    .tocItem .meta{display:flex; justify-content:space-between; align-items:center; gap:10px}
    .tocItem .chNo{font-family:var(--mono); font-size:12px; color:var(--muted)}
    .tocItem .pill{font-size:11px; color:var(--muted); border:1px solid rgba(255,255,255,.10); border-radius:999px; padding:3px 8px; background:rgba(255,255,255,.03)}
    .tocItem .name{font-size:14px; line-height:1.25}

    main.card{padding:16px}
    .hero{
      padding:14px; border-radius:16px; border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(122,162,255,.10), rgba(0,0,0,.12));
    }
    .heroTop{display:flex; gap:12px; align-items:flex-start; justify-content:space-between}
    .hero h2{margin:0; font-size:20px; letter-spacing:-0.01em}
    .hero .small{color:var(--muted); font-size:13px; line-height:1.45; margin-top:6px}

    .contentGrid{display:grid; grid-template-columns: 1fr; gap:12px; margin-top:12px}
    .panel{
      background:rgba(0,0,0,.16); border:1px solid rgba(255,255,255,.10);
      border-radius:16px; padding:14px;
    }
    .panel h3{margin:0 0 10px; font-size:14px; color:var(--muted); font-weight:600}
    .panel p{margin:0; line-height:1.6}

    .kv{display:grid; grid-template-columns: 1fr; gap:10px}
    .kvItem{padding:12px; border-radius:14px; border:1px dashed rgba(255,255,255,.14); background:rgba(255,255,255,.03)}
    .kvItem b{display:block; margin-bottom:6px; font-size:13px}
    .kvItem span{color:var(--muted); line-height:1.6; font-size:13px}

    .list{display:flex; flex-direction:column; gap:8px}
    details{border-radius:14px; border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.03); overflow:hidden}
    summary{
      cursor:pointer; padding:12px 12px; list-style:none;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      font-size:13px;
    }
    summary::-webkit-details-marker{display:none}
    .arrow{opacity:.7; transition:.15s ease}
    details[open] .arrow{transform:rotate(90deg); opacity:1}
    .detailsBody{padding:0 12px 12px; color:var(--muted); line-height:1.6; font-size:13px}

    .footer{
      margin-top:14px; padding:12px; border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.14);
      color:var(--muted); font-size:12px; line-height:1.6
    }

    .hl{background:rgba(122,162,255,.22); padding:0 4px; border-radius:6px}

    .toast{
      position:fixed; right:14px; bottom:14px; max-width:360px;
      background:rgba(16,26,56,.92); border:1px solid rgba(255,255,255,.12);
      color:var(--text); border-radius:14px; padding:12px 12px;
      box-shadow:var(--shadow); display:none;
      z-index:99;
    }
    .toast .t{font-size:13px; margin:0 0 4px}
    .toast .d{font-size:12px; color:var(--muted); margin:0}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>《The Secret of Our Success》 목차별 핵심 요약</h1>
        <div class="subtitle">조지프 헨릭의 핵심 논지를 <span class="hl">장(Chapter)</span> 단위로 탐색하는 인터랙티브 페이지</div>
        <div class="badgeRow">
          <div class="badge"><b>탐색</b> 검색 · 테마 필터 · 장 이동</div>
          <div class="badge"><b>학습</b> 핵심 요약 · 사례 · 핵심 문장</div>
          <div class="badge"><b>내보내기</b> JSON 복사(수업자료/노션/문서용)</div>
        </div>
      </div>
      <div class="badge" style="align-self:flex-start">v1 • 단일 HTML</div>
    </header>

    <div class="layout">
      <aside class="card side">
        <div class="toolbar">
          <div>
            <label for="q">검색</label>
            <input id="q" type="search" placeholder="예: 집단두뇌, 신뢰, 규범, 명망…" autocomplete="off" />
          </div>

          <div>
            <label>테마 필터</label>
            <div class="chips" id="chips"></div>
          </div>

          <div class="btnRow">
            <button id="expandAll">모두 펼치기</button>
            <button id="collapseAll">모두 접기</button>
            <button class="primary" id="copyJson">JSON 복사</button>
          </div>
        </div>

        <ul class="toc" id="toc"></ul>
      </aside>

      <main class="card">
        <section class="hero" id="hero">
          <div class="heroTop">
            <div>
              <h2 id="chTitle">장 선택: 왼쪽에서 클릭하세요</h2>
              <div class="small" id="chOneLiner">검색/필터로 원하는 주제의 장을 빠르게 찾을 수 있어요.</div>
            </div>
            <div class="badge" id="chTags" style="white-space:nowrap">—</div>
          </div>
        </section>

        <div class="contentGrid">
          <div class="panel">
            <h3>핵심 요약</h3>
            <p id="summary">왼쪽 목차에서 장을 선택하면 요약이 표시됩니다.</p>
          </div>

          <div class="panel">
            <h3>키포인트</h3>
            <div class="kv" id="keypoints"></div>
          </div>

          <div class="panel">
            <h3>주요 사례 (펼쳐보기)</h3>
            <div class="list" id="cases"></div>
          </div>

          <div class="panel">
            <h3>핵심 문장</h3>
            <p id="quote" style="font-style:italic; color:var(--text)">—</p>
          </div>
        </div>

        <div class="footer">
          <b>사용 팁</b>
          <ul style="margin:8px 0 0; padding-left:18px">
            <li>검색어는 <span class="hl">장 제목/요약/사례/키포인트</span> 전체에서 매칭됩니다.</li>
            <li>테마 필터는 여러 개를 <span class="hl">동시에</span> 선택할 수 있습니다.</li>
            <li>“JSON 복사”는 현재 필터/검색 결과에 해당하는 장만 내보냅니다.</li>
          </ul>
        </div>
      </main>
    </div>
  </div>

  <div class="toast" id="toast">
    <p class="t" id="toastT">완료</p>
    <p class="d" id="toastD">클립보드에 복사했습니다.</p>
  </div>

  <script>
    // Data is intentionally concise & structured so you can extend it easily.
    // You can edit/expand summaries, add citations, or attach image URLs.
    const CHAPTERS = [
      {
        id: 1,
        title: "수수께끼 같은 영장류",
        tags: ["프레이밍", "집단두뇌", "문화학습"],
        oneLiner: "개인으론 약하지만 집단으론 지구를 장악한 이유: 누적된 문화 지식.",
        summary: "인간 성공의 역설(개인은 취약하지만 종으로는 압도적)을 제시하고, 해답을 ‘개인 지능’이 아니라 세대를 거쳐 축적·전승되는 ‘문화적 지식(집단두뇌)’에서 찾는다.",
        keypoints: [
          {k:"문제", v:"왜 인간은 개체로는 연약한데도 지구상에서 가장 성공적인 종인가?"},
          {k:"핵심 주장", v:"성공의 비밀은 개인 두뇌가 아니라 집단두뇌(누적 문화)."},
          {k:"관점 전환", v:"‘똑똑해서’가 아니라 ‘잘 배워서’ 적응했다."}
        ],
        cases: [
          {t:"환경 적응의 대비", d:"혹독한 환경에서도 토착 집단은 지식으로 생존하지만, 문화 지식 없이 투입된 개인은 실패한다."},
          {t:"기술·제도의 힘", d:"도구/조리/규범 같은 문화가 생존 문제를 해결하는 ‘보이지 않는 인프라’가 된다."}
        ],
        quote: "우리 성공의 비밀은 각자의 두뇌가 아니라 집단의 두뇌—세대 간 축적된 문화 지식에 있다."
      },
      {
        id: 2,
        title: "우리가 똑똑해서 살아남았을까?",
        tags: ["비판", "인지", "문화학습"],
        oneLiner: "순수 지능 우월론을 흔들고 ‘사회적 학습’의 우위를 강조.",
        summary: "‘인간이 똑똑해서 지배종’이라는 통념을 재검토한다. 실험과 비교를 통해 인간이 모든 인지 영역에서 압도적이지 않음을 보이며, 결정적 차이는 사회적 학습 능력과 문화 전수 체계에 있다고 주장한다.",
        keypoints: [
          {k:"반박 대상", v:"일반지능/본능/개체 능력 중심 설명"},
          {k:"증거", v:"영장류 비교에서 사회적 학습 과제에서 인간 유아가 두드러짐"},
          {k:"결론", v:"지배의 핵심은 문화적 적응력"}
        ],
        cases: [
          {t:"유인원 vs 인간 유아", d:"공간·수량·인과 등은 격차가 작지만 사회적 학습에서는 큰 격차."},
          {t:"침팬지의 기억력", d:"특정 작업 기억 과제에서 침팬지가 인간을 능가한 보고는 ‘지능=항상 인간 우위’가 아님을 시사."}
        ],
        quote: "인간의 생태학적 성공은 IQ가 아니라 문화적 전승 덕분일 가능성이 크다."
      },
      {
        id: 3,
        title: "무인도에 떨어지면 살아남을 수 있을까",
        tags: ["생존", "사례", "문화지식"],
        oneLiner: "탐험대의 실패와 토착 지식의 힘으로 문화의 생존 가치를 입증.",
        summary: "실제 탐험 사례를 통해 문화 지식의 부재가 얼마나 치명적인지 보여준다. 첨단 장비와 인원이 있어도 현지의 누적 지식을 모르면 실패하며, 토착민은 같은 환경에서 번성한다.",
        keypoints: [
          {k:"핵심 메시지", v:"환경 적응의 열쇠는 ‘현지화된 문화 노하우’"},
          {k:"패턴", v:"고립/오만/학습 실패 → 생존 실패"},
          {k:"대조", v:"토착 지식 보유자는 동일 환경에서 안정적 생존"}
        ],
        cases: [
          {t:"프랭클린 북극 탐험대", d:"근처 자원이 있어도 이누이트 지식 없이 활용 못해 붕괴."},
          {t:"버크와 윌스", d:"현지 식물 처리법(독 제거 등) 미지로 영양실조·실패."}
        ],
        quote: "문화적 지식 없이는 최정예 인력도 자연 앞에서 무력해진다."
      },
      {
        id: 4,
        title: "문화적인 종을 만드는 법",
        tags: ["사회학습", "편향", "규범"],
        oneLiner: "누구에게서/무엇을 배울지 선택하는 학습 편향이 누적 문화를 가능케 했다.",
        summary: "인간이 ‘문화 의존 종’이 된 이유는 사회적 학습을 최적화하는 심리 기제(명망·성공 편향, 동조 등) 덕분이다. 이 편향들이 유용한 정보의 확산을 촉진하고, 때론 불필요한 요소까지 보존해 복잡한 기술 전수(누적 문화)를 가능케 했다.",
        keypoints: [
          {k:"학습 편향", v:"명망/성공/다수 추종(동조) 단서 활용"},
          {k:"과잉모방", v:"필요 없어 보여도 따라해 중요한 요소를 놓치지 않음"},
          {k:"규범 학습", v:"규칙을 관찰로 습득하고 자발적으로 집행"}
        ],
        cases: [
          {t:"과잉모방 실험", d:"불필요한 동작까지 복제해 전통·의례가 안정적으로 전승."},
          {t:"명망 편향", d:"유능해 보이는 모델을 따라 배우는 것이 탐색 비용을 줄임."}
        ],
        quote: "우리는 ‘가르치고 배우는 동물’로 진화했고, 그게 누적 문화의 토대다."
      },
      {
        id: 5,
        title: "문화가 우리 몸을 약하게 만들었다",
        tags: ["문화-유전", "조리", "신체"],
        oneLiner: "도구·불·조리가 신체 선택압을 바꾸며 몸을 재설계했다.",
        summary: "문화 혁신(조리, 도구)이 생존 방식 자체를 바꾸면서 턱·치아·소화기관 등 신체에 가해지는 선택압을 바꿨다. 결과적으로 ‘약해진’ 부분이 있지만, 그만큼 에너지가 뇌 발달과 학습에 재배분되었다.",
        keypoints: [
          {k:"핵심", v:"문화가 생물학적 진화를 유도(문화-유전 공진화)"},
          {k:"조리", v:"소화 비용 감소 → 턱/장 축소, 에너지 여유"},
          {k:"도구", v:"신체적 부담을 외부화 → 정교성/협력 강화"}
        ],
        cases: [
          {t:"불과 조리", d:"익힌 음식은 소화 효율을 높여 신체 구조 변화에 연결."},
          {t:"용기·저장", d:"물·식량 저장이 이동/사냥 방식을 바꾸고 적응 폭을 넓힘."}
        ],
        quote: "문화가 일을 대신하면서 우리의 몸과 뇌는 다른 방식으로 최적화되었다."
      },
      {
        id: 6,
        title: "왜 어떤 사람들은 눈이 파랄까",
        tags: ["문화-유전", "식생활", "성선택"],
        oneLiner: "문화(식단·습관·선호)가 유전자 선택을 바꾼 구체 사례들.",
        summary: "락타아제 지속성, 알코올 대사 변이 등은 문화적 생활양식(목축, 음주 등)이 만든 선택압의 결과다. 특정 신체 형질(예: 눈 색)도 문화적 선호(성선택)와 연결될 수 있음을 논한다.",
        keypoints: [
          {k:"개념", v:"문화가 새로운 환경을 만들고 유전자가 거기에 적응"},
          {k:"속도", v:"문화 변화는 빠르고, 그에 대한 유전 적응도 가속 가능"},
          {k:"확장", v:"성선택/규범도 형질 빈도에 영향"}
        ],
        cases: [
          {t:"우유 소화 능력", d:"목축 문화가 성인 락타아제 발현을 선택."},
          {t:"알코올 대사", d:"음주·발효 문화가 대사 유전자 분포에 영향."}
        ],
        quote: "인간 게놈의 일부 변화는 문화라는 방향키가 이끈 결과다."
      },
      {
        id: 7,
        title: "신뢰의 기원에 관하여",
        tags: ["신뢰", "의례", "CREDs"],
        oneLiner: "비합리처럼 보이는 믿음도 ‘신뢰 신호’로 기능한다.",
        summary: "사람들이 큰 비용을 요구하는 믿음을 무조건 수용하는 게 아니라, 모범자가 비용을 감수하는 행동(CREDs)을 보고 신뢰를 형성한다는 관점을 제시한다. 의례·금기는 경험적 지식을 암호화해 전달하거나 집단 결속을 강화할 수 있다.",
        keypoints: [
          {k:"CREDs", v:"비용을 치르는 행동이 믿음의 신빙성을 높임"},
          {k:"의례/금기", v:"지식 전수·집단 결속·갈등 완화 기능"},
          {k:"과잉모방", v:"이유를 몰라도 전통을 보존해 라쳇 효과를 지원"}
        ],
        cases: [
          {t:"옥수수 조리 전통", d:"효용을 몰라도 건강에 이득인 처리법이 전통으로 유지."},
          {t:"고통스러운 의례", d:"헌신의 신호로 신뢰·연대를 강화."}
        ],
        quote: "사람들은 아무거나 믿지 않는다—대가가 큰 믿음일수록 행동으로 검증한다."
      },
      {
        id: 8,
        title: "명망과 권력, 그리고 폐경",
        tags: ["명망", "리더십", "생애사"],
        oneLiner: "힘이 아닌 ‘배움의 대상’인 명망이 사회를 이끈다.",
        summary: "리더십에는 권력(두려움)과 명망(존경)이 있고, 인간은 학습 이득 때문에 명망에 특히 민감하다. 또한 ‘폐경’은 할머니 역할(돌봄·지식 전수)과 연결되어 문화적 종의 생애사 특성을 설명한다.",
        keypoints: [
          {k:"리더십 2종", v:"권력(해코지) vs 명망(가치 제공)"},
          {k:"학습 논리", v:"잘 배우려면 능력자를 따르는 게 이득"},
          {k:"폐경", v:"돌봄·전수로 후손 생존률을 올리는 가설"}
        ],
        cases: [
          {t:"사냥 능력자", d:"공유와 기술로 존경을 얻고 자발적 추종을 유도."},
          {t:"할머니의 지식", d:"환경·식단·돌봄 노하우가 집단 적응에 기여."}
        ],
        quote: "인간은 힘보다 지식과 명망을 따라 움직이도록 진화해왔다."
      },
      {
        id: 9,
        title: "사돈, 근친상간 금기와 의례",
        tags: ["친족", "동맹", "규범"],
        oneLiner: "결혼/금기/의례가 혈연을 넘어 협력 범위를 확장한다.",
        summary: "근친상간 금기와 결혼 제도는 집단 간 혼인 동맹을 촉진해 대규모 협력 네트워크를 만든다. 통과의례와 집단 의례는 상징적 친족을 만들어 신뢰·협동을 강화한다.",
        keypoints: [
          {k:"동맹 메커니즘", v:"혼인 → 사돈 관계 → 교류/평화/자원 공유"},
          {k:"혈연 초월", v:"의례가 ‘우리’ 경계를 넓힘"},
          {k:"규범의 역할", v:"협력의 룰을 안정적으로 유지"}
        ],
        cases: [
          {t:"혼인 네트워크", d:"배우자 교환이 갈등 비용을 낮추고 협력 채널을 만든다."},
          {t:"통과의례", d:"공동 경험이 결속을 만들고 규범 준수를 강화."}
        ],
        quote: "문화적 친족 만들기가 낯선 이와의 협력을 가능케 했다."
      },
      {
        id: 10,
        title: "집단 간 경쟁이 만든 문화적 진화의 틀",
        tags: ["집단선택", "경쟁", "규범"],
        oneLiner: "더 협동적·혁신적 문화가 경쟁에서 살아남아 확산한다.",
        summary: "집단 대 집단 경쟁은 규범·제도·기술의 ‘문화적 선택’을 강화했다. 협력과 혁신을 더 잘 조직하는 집단이 우세했고, 성공한 문화는 모방·확산되며 인류 전반의 문화 수준을 끌어올렸다.",
        keypoints: [
          {k:"핵심", v:"경쟁은 문화 혁신의 가속기"},
          {k:"확산", v:"승자 문화가 전파/모방됨"},
          {k:"규범", v:"협력 규범이 강한 집단이 유리"}
        ],
        cases: [
          {t:"군율/조직력", d:"규칙 기반 협력이 전쟁·자원 경쟁에서 우위를 만들 수 있음."},
          {t:"연합과 흡수", d:"작은 집단은 연합하거나 동화되어 규모를 키움."}
        ],
        quote: "문화도 경쟁 속에서 선택된다—협력과 혁신을 잘하는 문화가 살아남는다."
      },
      {
        id: 11,
        title: "자기 길들이기",
        tags: ["규범", "처벌", "사회성"],
        oneLiner: "규범과 제재가 공격성을 누르고 협동 심리를 강화했다.",
        summary: "인간은 사회적 규범과 처벌을 통해 공격적·비협조적 성향을 억제하는 방향으로 스스로를 ‘길들였다’. 규범은 내면화되어 죄책감/수치심/공정 분노 같은 심리를 만들고, 내집단 협력을 강화한다.",
        keypoints: [
          {k:"메커니즘", v:"규범 위반자 배제/처벌 → 성향 필터링"},
          {k:"내면화", v:"규범 준수가 자동적 동기 체계로 자리"},
          {k:"양면성", v:"내집단 친사회성 강화 + 외집단 긴장 가능"}
        ],
        cases: [
          {t:"처벌 선호", d:"비용을 내서라도 규범 위반자를 벌주려는 심리."},
          {t:"가족 제도", d:"짝결합·친족 규범이 협력을 안정화."}
        ],
        quote: "문화적 규범은 우리를 협동에 맞게 ‘자기 길들이기’했다."
      },
      {
        id: 12,
        title: "집단두뇌",
        tags: ["집단두뇌", "혁신", "네트워크"],
        oneLiner: "인구×연결이 지식 축적의 엔진—작고 고립되면 기술이 퇴보한다.",
        summary: "집단두뇌는 인구 규모와 연결망에 비례해 커지며, 누적 문화의 복잡도를 결정한다. 고립·소규모 집단은 복잡한 기술을 유지하기 어렵고(태즈메이니아 효과), 큰 네트워크는 혁신과 유지가 쉽다.",
        keypoints: [
          {k:"정의", v:"지식이 개인을 넘어 집단 네트워크에 분산된 상태"},
          {k:"임계", v:"너무 작은 집단은 전수 실패로 지식이 소실"},
          {k:"현대적 함의", v:"연결망/개방성이 혁신 속도를 좌우"}
        ],
        cases: [
          {t:"태즈메이니아 효과", d:"고립된 소규모 집단에서 기술 복잡도가 감소할 수 있음."},
          {t:"실험 연구", d:"큰 집단일수록 도구 제작이 누적 개선되는 경향."}
        ],
        quote: "혁신은 천재보다 집단두뇌—연결된 많은 머리에서 나온다."
      },
      {
        id: 13,
        title: "규칙이 있는 의사소통 도구",
        tags: ["언어", "기호", "문화진화"],
        oneLiner: "언어/문자/숫자는 사회가 쓰기 쉽도록 문화적으로 진화한다.",
        summary: "언어와 기호 체계는 인간이 발명하고 사용하면서 ‘학습하기 쉬운 방향’으로 진화해왔다. 피진→크리올, 문자·수 체계의 표준화 등은 집단 사용 과정이 구조를 선택/정제한다는 점을 보여준다.",
        keypoints: [
          {k:"언어의 진화", v:"사용자에게 적응—규칙성/효율성 강화"},
          {k:"도구 확장", v:"문자·숫자가 기억/계산 능력을 외부화"},
          {k:"사회적 신뢰", v:"약속·계약·법이 말의 협력을 강화"}
        ],
        cases: [
          {t:"피진→크리올", d:"아이들이 언어에 규칙을 부여해 문법 체계가 생김."},
          {t:"문자 발명", d:"정보 축적과 전수의 범위를 급격히 확장."}
        ],
        quote: "언어와 기호는 ‘사람이 배우기 좋은 방향’으로 스스로 진화한다."
      },
      {
        id: 14,
        title: "문화에 동화된 뇌와 명예로운 호르몬",
        tags: ["뇌", "호르몬", "문화심리"],
        oneLiner: "문화는 뇌 구조와 생리 반응(호르몬)까지 바꾼다.",
        summary: "문화적 훈련과 규범은 신경가소성을 통해 뇌를 재구성하고, 같은 자극에도 문화권마다 호르몬 반응이 달라질 수 있다(예: 명예문화의 테스토스테론 반응). 심리적 의미가 생물학을 작동시킨다.",
        keypoints: [
          {k:"신경가소성", v:"학습과 직업 훈련이 뇌 구조 변화"},
          {k:"문화적 의미", v:"모욕/명예 같은 해석이 생리 반응을 조절"},
          {k:"함의", v:"집단 차이는 유전만이 아니라 사회화의 결과"}
        ],
        cases: [
          {t:"택시기사 연구", d:"복잡한 공간 학습이 해마 발달과 연관."},
          {t:"명예문화", d:"모욕 상황에서 호르몬 반응이 더 크게 나타날 수 있음."}
        ],
        quote: "같은 인간이라도 문화에 따라 뇌와 몸이 다르게 반응한다."
      },
      {
        id: 15,
        title: "진화의 문턱",
        tags: ["전환점", "문화-유전", "라쳇"],
        oneLiner: "문화가 유전 진화를 이끄는 ‘새 게임’이 시작된 임계 시점.",
        summary: "어느 시점부터 문화가 적응의 핵심이 되며, 문화 축적이 커질수록 더 잘 배우는 유전적·발달적 특성이 선택되는 자가촉매 루프가 발생했다. 한번 문턱을 넘으면 되돌리기 어렵다.",
        keypoints: [
          {k:"임계", v:"문화 의존이 생존에 필수인 상태로 전환"},
          {k:"피드백", v:"문화 축적 ↔ 학습 능력/뇌 발달 강화"},
          {k:"불가역성", v:"자연인으로의 회귀는 실질적으로 불가능"}
        ],
        cases: [
          {t:"도구·조리의 축적", d:"기술 난이도가 올라갈수록 사회적 학습의 이점이 커짐."},
          {t:"라쳇 효과", d:"한 번 쌓인 지식이 쉽게 사라지지 않도록 전수 구조가 발달."}
        ],
        quote: "문화가 유전 진화를 이끄는 새로운 게임—그 문턱을 넘는 순간이 있었다."
      },
      {
        id: 16,
        title: "왜 인간이었을까?",
        tags: ["비교", "유인원", "조건"],
        oneLiner: "조건(사회·생태·신체)이 맞아 문화 루프가 시작된 건 인간이었다.",
        summary: "다른 동물도 학습하지만, 인간은 집단 간 교류·협동 양육·가르침·도구 사용 등 여러 조건이 맞물려 문화 진화의 임계점을 넘었다. 그 이후에는 가속 루프가 작동해 격차가 벌어졌다.",
        keypoints: [
          {k:"사회 구조", v:"교류/협동 양육/가르침이 학습을 증폭"},
          {k:"신체 조건", v:"손·발성·도구 사용의 결합"},
          {k:"가속", v:"임계점 이후 문화-유전 공진화가 폭주"}
        ],
        cases: [
          {t:"침팬지의 한계", d:"집단 간 적대/교류 부족으로 누적 문화가 제한."},
          {t:"협동 양육", d:"다수 모델과 장기 학습이 큰 문화 축적을 가능케 함."}
        ],
        quote: "필연과 우연이 겹쳐, 문화 진화의 폭주 기관차에 올라탄 종이 인간이었다."
      },
      {
        id: 17,
        title: "문화적 진화가 만들어낸 신종 동물",
        tags: ["종합", "정책", "설계"],
        oneLiner: "인간 본성=문화와 유전의 이중나선—사회 설계에도 함의.",
        summary: "책 전체를 종합해 인간을 ‘문화적 진화가 만든 동물’로 규정한다. 학습 편향, 신뢰 신호, 규범의 내면화, 집단두뇌, 문화 다양성의 함의를 정리하며, 사회 개선은 의도적 설계보다 ‘변이-선택’에 가까운 실험과 학습으로 접근해야 함을 강조한다.",
        keypoints: [
          {k:"핵심", v:"인간 본성은 문화와 유전이 함께 만든 결과"},
          {k:"주의", v:"제도 이식은 문화 맥락을 무시하면 실패"},
          {k:"제안", v:"작은 실험과 경쟁(변이-선택)을 통해 제도를 개선"}
        ],
        cases: [
          {t:"제도 이식의 실패", d:"다른 문화권에서 같은 제도가 다르게 작동할 수 있음."},
          {t:"정책 실험", d:"A/B 테스트처럼 문화진화 원리를 본뜬 개선 방식."}
        ],
        quote: "우리는 문화적 진화가 만들어낸 신종 동물이며, 사회를 바꾸려면 그 원리를 이해해야 한다."
      }
    ];

    const THEMES = [
      {id:"집단두뇌", label:"집단두뇌"},
      {id:"문화학습", label:"문화학습"},
      {id:"규범", label:"규범"},
      {id:"문화-유전", label:"문화-유전"},
      {id:"신뢰", label:"신뢰"},
      {id:"명망", label:"명망"},
      {id:"언어", label:"언어"},
      {id:"뇌", label:"뇌"},
      {id:"경쟁", label:"집단 경쟁"},
      {id:"정책", label:"정책/설계"},
      {id:"사례", label:"사례 중심"}
    ];

    const el = (sel) => document.querySelector(sel);
    const els = (sel) => Array.from(document.querySelectorAll(sel));

    const state = {
      q: "",
      themes: new Set(),
      activeId: null,
      expandAll: false,
    };

    function normalize(s){
      return (s||"").toLowerCase().replace(/\s+/g," ").trim();
    }

    function matchChapter(ch){
      const q = normalize(state.q);
      const themeOk = state.themes.size === 0 || ch.tags.some(t => state.themes.has(t) || (t==="사례" && state.themes.has("사례")));
      if(!themeOk) return false;
      if(!q) return true;
      const blob = [
        ch.title, ch.oneLiner, ch.summary, ch.quote,
        ...(ch.tags||[]),
        ...(ch.keypoints||[]).flatMap(kv => [kv.k, kv.v]),
        ...(ch.cases||[]).flatMap(c => [c.t, c.d])
      ].join(" ");
      return normalize(blob).includes(q);
    }

    function filtered(){
      return CHAPTERS.filter(matchChapter);
    }

    function renderChips(){
      const root = el('#chips');
      root.innerHTML = '';
      THEMES.forEach(t => {
        const chip = document.createElement('div');
        chip.className = 'chip' + (state.themes.has(t.id) ? ' active' : '');
        chip.textContent = t.label;
        chip.title = `필터: ${t.label}`;
        chip.addEventListener('click', () => {
          if(state.themes.has(t.id)) state.themes.delete(t.id);
          else state.themes.add(t.id);
          // map composite theme
          if(t.id === '집단 경쟁') {
            // no-op
          }
          render();
        });
        root.appendChild(chip);
      });

      // Add quick mapping: if user clicks "집단 경쟁" chip, map to tag "경쟁"
      // We'll implement by aliasing: when themes contains "집단 경쟁", treat as "경쟁"
      if(state.themes.has('집단 경쟁')){
        state.themes.delete('집단 경쟁');
        state.themes.add('경쟁');
      }
      // For policy chip alias
      if(state.themes.has('정책/설계')){
        state.themes.delete('정책/설계');
        state.themes.add('정책');
      }
    }

    function renderTOC(){
      const list = el('#toc');
      const items = filtered();
      list.innerHTML = '';

      if(items.length === 0){
        const empty = document.createElement('div');
        empty.className = 'panel';
        empty.style.marginTop = '12px';
        empty.innerHTML = `<h3 style="margin:0 0 6px; font-size:13px; color:var(--text)">결과 없음</h3>
          <p style="margin:0; color:var(--muted); font-size:13px; line-height:1.6">검색어/필터를 바꿔보세요.</p>`;
        list.appendChild(empty);
        return;
      }

      items.forEach(ch => {
        const li = document.createElement('li');
        li.className = 'tocItem' + (state.activeId === ch.id ? ' active' : '');
        li.setAttribute('role','button');
        li.tabIndex = 0;
        li.innerHTML = `
          <div class="meta">
            <span class="chNo">CH ${String(ch.id).padStart(2,'0')}</span>
            <span class="pill">${ch.tags.slice(0,2).join(' · ')}</span>
          </div>
          <div class="name">${escapeHtml(ch.title)}</div>
        `;
        li.addEventListener('click', () => selectChapter(ch.id));
        li.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' ') selectChapter(ch.id);
        });
        list.appendChild(li);
      });

      // Ensure active chapter still visible
      const active = list.querySelector('.tocItem.active');
      if(active) active.scrollIntoView({block:'nearest'});
    }

    function selectChapter(id){
      state.activeId = id;
      const ch = CHAPTERS.find(c => c.id === id);
      if(!ch) return;

      el('#chTitle').textContent = `CH ${String(ch.id).padStart(2,'0')} · ${ch.title}`;
      el('#chOneLiner').textContent = ch.oneLiner;
      el('#chTags').textContent = ch.tags.join(' · ');

      el('#summary').textContent = ch.summary;

      const kp = el('#keypoints');
      kp.innerHTML = '';
      (ch.keypoints || []).forEach(({k,v}) => {
        const box = document.createElement('div');
        box.className = 'kvItem';
        box.innerHTML = `<b>${escapeHtml(k)}</b><span>${escapeHtml(v)}</span>`;
        kp.appendChild(box);
      });

      const cs = el('#cases');
      cs.innerHTML = '';
      (ch.cases || []).forEach(({t,d}) => {
        const det = document.createElement('details');
        if(state.expandAll) det.open = true;
        det.innerHTML = `
          <summary>
            <span>${escapeHtml(t)}</span>
            <span class="arrow">▸</span>
          </summary>
          <div class="detailsBody">${escapeHtml(d)}</div>
        `;
        cs.appendChild(det);
      });

      el('#quote').textContent = `“${ch.quote}”`;

      renderTOC();
      // Update URL hash for shareable linking
      history.replaceState(null, '', `#ch-${id}`);
    }

    function render(){
      renderChips();
      renderTOC();

      // If active chapter is filtered out, select first available
      const items = filtered();
      if(!items.length){
        state.activeId = null;
        el('#chTitle').textContent = '장 선택: 왼쪽에서 클릭하세요';
        el('#chOneLiner').textContent = '검색/필터로 원하는 주제의 장을 빠르게 찾을 수 있어요.';
        el('#chTags').textContent = '—';
        el('#summary').textContent = '왼쪽 목차에서 장을 선택하면 요약이 표시됩니다.';
        el('#keypoints').innerHTML = '';
        el('#cases').innerHTML = '';
        el('#quote').textContent = '—';
        return;
      }
      if(state.activeId == null || !items.some(i => i.id === state.activeId)){
        selectChapter(items[0].id);
      }
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    function toast(title, desc){
      const t = el('#toast');
      el('#toastT').textContent = title;
      el('#toastD').textContent = desc;
      t.style.display = 'block';
      clearTimeout(toast._timer);
      toast._timer = setTimeout(() => { t.style.display = 'none'; }, 2200);
    }

    // Events
    el('#q').addEventListener('input', (e) => {
      state.q = e.target.value;
      render();
    });

    el('#expandAll').addEventListener('click', () => {
      state.expandAll = true;
      // open all details in current view
      els('#cases details').forEach(d => d.open = true);
      toast('모두 펼침', '현재 선택한 장의 사례를 모두 펼쳤습니다.');
    });

    el('#collapseAll').addEventListener('click', () => {
      state.expandAll = false;
      els('#cases details').forEach(d => d.open = false);
      toast('모두 접음', '현재 선택한 장의 사례를 모두 접었습니다.');
    });

    el('#copyJson').addEventListener('click', async () => {
      const payload = {
        book: "The Secret of Our Success",
        author: "Joseph Henrich",
        generated_at: new Date().toISOString(),
        filters: { query: state.q, themes: Array.from(state.themes) },
        chapters: filtered()
      };
      try{
        await navigator.clipboard.writeText(JSON.stringify(payload, null, 2));
        toast('JSON 복사 완료', '필터/검색 결과 기준으로 복사했습니다.');
      }catch(err){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = JSON.stringify(payload, null, 2);
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
        toast('JSON 복사 완료', '클립보드 접근이 제한되어 대체 방식으로 복사했습니다.');
      }
    });

    // Hash routing
    function initFromHash(){
      const m = location.hash.match(/#ch-(\d+)/);
      if(m){
        const id = Number(m[1]);
        if(CHAPTERS.some(c => c.id === id)){
          state.activeId = id;
        }
      }
    }

    // Theme alias cleanup (support the visible labels)
    // If you want exact mapping, adjust THEMES above.

    initFromHash();
    render();
  </script>
</body>
</html>
